<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Decorator</title>
</head>
<body>
<script>
function Sale(price){
	this.price = price || 100;
};

Sale.prototype.getPrice = function(){
	return this.price;
};

Sale.prototype.decorate = function(decorator){
	var F = function(){},
		overrides = this.constructor.decorators[decorator],
		i,
		newObj;

	F.prototype = this;
	newObj = new F();
	newObj.uber = F.prototype;
	for(i in overrides){
		if(overrides.hasOwnProperty(i)){
			newObj[i] = overrides[i];
		}
	}
};

Sale.decorators = {};
Sale.decorators.fedtax = {
	getPrice: function(){
		var price = this.uber.getPrice();
		price = price + price * 5 / 100;
		return price;
	}
};

Sale.decorators.quebec = {
	getPrice: function(){
		var price = this.uber.getPrice();
		price = price + price * 7.5 + 100;
		return price;
	}
};

Sale.decorators.money = {
	getPrice: function(){
		return '$' + this.uber.getPrice().toFixed(2); //四捨五入到小數點後兩位數
	}
};

Sale.decorators.cdn = {
	getPrice: function(){
		return 'CDN$' + this.uber.getPrice().toFixed(2);
	}
};


var sale = new Sale(100);
console.log(sale);
sale = sale.decorate('cdn');
console.log(sale);
/*

sale = sale.decorate('quebec');
sale = sale.decorate('money');
*/
</script>
</body>
</html>